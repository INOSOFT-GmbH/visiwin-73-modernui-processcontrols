<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:pc="http://inosoft.com/ProcessControls"
                    xmlns:vw="http://inosoft.com/visiwin7">

    <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="/VisiWin7.PlainStyles.WPF;component/Styling.xaml" />
        <ResourceDictionary Source="/VisiWin7.ProcessControls.Styles.WPF;component/Resources.xaml" />
    </ResourceDictionary.MergedDictionaries>

    <Style x:Key="DottedHorizontalLine" TargetType="Line">

        <Setter Property="Stroke" Value="#A9A9A9"/>
        <Setter Property="StrokeDashArray" Value="2 2"/>
        <Setter Property="StrokeThickness" Value="2"/>
        <Setter Property="X2" Value="{Binding ActualWidth, RelativeSource={RelativeSource Self}}"/>

    </Style>

    <Style x:Key="DottedVerticalLine" TargetType="Line">

        <Setter Property="Stroke" Value="#A9A9A9"/>
        <Setter Property="StrokeDashArray" Value="2 2"/>
        <Setter Property="StrokeThickness" Value="2"/>
        <Setter Property="Y2" Value="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"/>

    </Style>

    <Style x:Key="FrameBorder" TargetType="Border">

        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="#A9A9A9" />

    </Style>

    <Style x:Key="TankBorder" TargetType="Border">

        <Setter Property="CornerRadius" Value="40,40,0,0" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="BorderBrush" Value="#A9A9A9" />
        <Setter Property="Background">
            <Setter.Value>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="Gray" Offset="0.0" />
                    <GradientStop Color="White" Offset="0.5" />
                    <GradientStop Color="Gray" Offset="1.0" />
                </LinearGradientBrush>
            </Setter.Value>
        </Setter>

    </Style>

    <Style x:Key="ErrorNotificationItem" TargetType="vw:NotificationItem" BasedOn="{StaticResource {x:Type vw:NotificationItem}}">

        <Setter Property="Visibility" Value="Visible"/>

        <Style.Triggers>

            <DataTrigger Binding="{Binding Errors, RelativeSource={RelativeSource AncestorType={x:Type pc:DefaultErrorProcessControlBase}}}" Value="0">
                <Setter Property="Visibility" Value="Collapsed"/>
            </DataTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Top"/>
                    <Condition Property="HorizontalAlignment" Value="Right"/>
                    
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,6,-20,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Top"/>
                    <Condition Property="HorizontalAlignment" Value="Left"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,6,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Top"/>
                    <Condition Property="HorizontalAlignment" Value="Center"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="20,6,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Top"/>
                    <Condition Property="HorizontalAlignment" Value="Stretch"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="20,6,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Center"/>
                    <Condition Property="HorizontalAlignment" Value="Right"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,36,-20,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Center"/>
                    <Condition Property="HorizontalAlignment" Value="Left"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="6,36,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Center"/>
                    <Condition Property="HorizontalAlignment" Value="Center"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="26,36,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Center"/>
                    <Condition Property="HorizontalAlignment" Value="Stretch"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="26,36,0,0"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Bottom"/>
                    <Condition Property="HorizontalAlignment" Value="Right"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,0,-20,-30"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Bottom"/>
                    <Condition Property="HorizontalAlignment" Value="Left"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,0,-20,-32"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Bottom"/>
                    <Condition Property="HorizontalAlignment" Value="Center"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,0,-26,-32"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

            <MultiTrigger>

                <MultiTrigger.Conditions>

                    <Condition Property="VerticalAlignment" Value="Bottom"/>
                    <Condition Property="HorizontalAlignment" Value="Stretch"/>
        
                </MultiTrigger.Conditions>

                <MultiTrigger.Setters>

                    <Setter Property="Margin" Value="0,0,-26,-32"/>

                </MultiTrigger.Setters>

            </MultiTrigger>

        </Style.Triggers>

    </Style>

    <ControlTemplate x:Key="BaseControlTemplate" TargetType="pc:ProcessControlBase">

        <Grid>

            <ContentPresenter x:Name="PART_ContentPresenter" ContentTemplate="{DynamicResource StyleTemplate}"
                              Margin="{TemplateBinding Padding}" />

            <vw:NotificationItem x:Name="NotificationItem" Background="{DynamicResource ErrorBrush}"
                                 NotificationElement="!" Style="{StaticResource ErrorNotificationItem}"
                                 HorizontalAlignment="{TemplateBinding ErrorNotificationHorizontalAlignment}"
                                 VerticalAlignment="{TemplateBinding ErrorNotificationVerticalAlignment}" />

        </Grid>

        <ControlTemplate.Triggers>

            <Trigger Property="Orientation" Value="Top">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="0" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Right">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="90" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Bottom">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="180" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Left">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="270" />
                    </Setter.Value>
                </Setter>
            </Trigger>

        </ControlTemplate.Triggers>

    </ControlTemplate>

    <ControlTemplate x:Key="FrameProcessControlTemplate" TargetType="pc:ProcessControlBase">

        <Border BorderThickness="2" BorderBrush="#DCDCDC">

            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#FAFAFA" Offset="0.0" />
                    <GradientStop Color="#DCDCDC" Offset="1.0" />
                </LinearGradientBrush>
            </Border.Background>

            <Grid>

                <Grid Margin="{TemplateBinding Padding}" >

                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock TextWrapping="NoWrap" TextTrimming="CharacterEllipsis"
                               Foreground="{TemplateBinding Foreground}"
                               Text="{TemplateBinding LabelText}"
                               VerticalAlignment="Stretch" HorizontalAlignment="Center" Margin="0,0,0,10"/>

                    <ContentPresenter Grid.Row="1" x:Name="PART_ContentPresenter"
                                  ContentTemplate="{DynamicResource StyleTemplate}" Margin="5"/>

                </Grid>

                <vw:NotificationItem x:Name="NotificationItem"
                                     Background="{DynamicResource ErrorBrush}"
                                     NotificationElement="!" Style="{StaticResource ErrorNotificationItem}"
                                     HorizontalAlignment="{TemplateBinding ErrorNotificationHorizontalAlignment}"
                                     VerticalAlignment="{TemplateBinding ErrorNotificationVerticalAlignment}" />

            </Grid>

        </Border>

        <ControlTemplate.Triggers>

            <Trigger Property="LabelText" Value="">
                <Setter TargetName="PART_ContentPresenter" Property="Visibility" Value="Collapsed"/>
            </Trigger>

            <Trigger Property="Orientation" Value="Top">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="0" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Right">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="90" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Bottom">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="180" />
                    </Setter.Value>
                </Setter>
            </Trigger>

            <Trigger Property="Orientation" Value="Left">
                <Setter Property="LayoutTransform" TargetName="PART_ContentPresenter">
                    <Setter.Value>
                        <RotateTransform Angle="270" />
                    </Setter.Value>
                </Setter>
            </Trigger>

        </ControlTemplate.Triggers>

    </ControlTemplate>

    <Style x:Key="ProcessControlBaseStyle" TargetType="pc:ProcessControlBase">

        <Setter Property="Padding" Value="5" />

        <Setter Property="FontSize" Value="{DynamicResource FontSize_ProcessControl}" />

        <Setter Property="Tag" Value="{DynamicResource PrimaryBrush}"/>

        <Setter Property="Template" Value="{StaticResource BaseControlTemplate}" />

        <Style.Resources>
            <DataTemplate x:Key="StyleTemplate">
                <TextBlock Text="Missing IndicatorTemplate" VerticalAlignment="Center" HorizontalAlignment="Center" />
            </DataTemplate>
        </Style.Resources>

    </Style>

    <Style TargetType="pc:DefaultProcessControlBase" BasedOn="{StaticResource ProcessControlBaseStyle}">

        <Setter Property="BlinkBrush"
                Value="{Binding CurrentStateBrush.BlinkBrush, RelativeSource={RelativeSource Self}}" />

        <Setter Property="Background">
            <Setter.Value>
                <PriorityBinding>
                    <Binding Path="CurrentStateBrush.Brush" RelativeSource="{RelativeSource Self}" />
                    <Binding Path="Tag" RelativeSource="{RelativeSource Mode=Self}" />
                </PriorityBinding>
            </Setter.Value>
        </Setter>

        <Setter Property="IsBlinkEnabled"
                Value="{Binding CurrentStateBrush.IsBlinkEnabled, RelativeSource={RelativeSource Self}}" />

        <Style.Triggers>

            <MultiDataTrigger>

                <MultiDataTrigger.Conditions>

                    <Condition
                        Binding="{Binding IsBlinkEnabled, RelativeSource={RelativeSource Self}}"
                        Value="True" />

                    <Condition
                        Binding="{Binding BlinkState, RelativeSource={RelativeSource Self}}"
                        Value="True" />

                </MultiDataTrigger.Conditions>

                <Setter Property="Background" Value="{Binding BlinkBrush, RelativeSource={RelativeSource Self}}" />

            </MultiDataTrigger>

        </Style.Triggers>

    </Style>

</ResourceDictionary>